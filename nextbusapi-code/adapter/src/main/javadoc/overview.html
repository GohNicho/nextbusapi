<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
         A Service Adapter for the NextBus Public XML Feed.
         <p>
             Extensive UML is provided in the Domain and Service package JavaDocs.
         </p>
         <p>
             Here's a same code snippet of how to Walk and Sort down the NextBus Service using this API:
         </p>
        <pre>
INextBusService service = SimplestNextbusServiceAdapter();

// Choose the TTC 
Agency ttc = service.getAgency("ttc");
List&lt;Route&gt; ttcRoutes  = service.getRoutes(ttc);

// Choose the TTC 506 streetcar
Route route = Route.find(ttcRoutes, "506");
RouteConfiguration routeConf = service.getRouteConfiguration(route);
List&lt;Stop&gt; stops = routeConf.getStops();

// Find the 3 nearest stops from me in under 1/2 mi
Geolocation here = new Geolocation(42.42121, -71.09336);
List&lt;Stop&gt; closestStops = Geolocation.sortedByClosest(stops, here, 10, 45);

// For those three closest stops, get the current Arrival Predictions
List&lt;PredictionGroup&gt; predictions = service.getPredictions(closestStops);


// Report on what we've found

System.out.println("For Route 506 there are " + closestStops.size() + " nearby stops");
System.out.println("The three closest stop to you are:");
for (Stop s: closestStops) {
    System.out.println("    " + s.getTitle() + "  " + s.getGeolocation().getDistanceInMiles(here) + " miles away");
}

System.out.println("Arrival predictions follow for your closest stops");
System.out.println("*************************************************");
for (PredictionGroup predictionGroup : predictions) {
    for (PredictionGroup.PredictionDirection predictionDirection : predictionGroup.getDirections()) {
        for (Prediction p : predictionDirection.getPredictions()) {
            // Direction d = routeConf.getDirectionById(p.getDirectionId());
            System.out.printf("%s %s   %s %tk:%&lt;tM\n", p.getVehicle(),
                                                          p.getDirectionId(),
                                                          p.getPredictedArrivalOrDepartureMinutes(),
                                                          p.getPredictedArrivalOrDepartureTimeUTC());
        }
    }
}

System.out.println("Vehicles on route");
System.out.println("*****************");
for (VehicleLocation v : svc.getVehicleLocations(route, 0)) {
    // Direction d = routeConf.getDirectionById(v.getDirectionId());
    System.out.printf("%s %s %.1f miles away from ,e.\n", v.getVehicle(), v.getDirectionId(), v.getGeolocation().getDistanceInMiles(here));
}
        </pre>
    </body>
</html>
